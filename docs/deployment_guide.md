# Инструкция по развертыванию BookPilot

Этот документ содержит подробные инструкции по развертыванию проекта BookPilot на платформах Vercel (фронтенд) и Railway (бэкенд).

## Подготовка к развертыванию

### Предварительные требования

1. Аккаунт на [GitHub](https://github.com)
2. Аккаунт на [Vercel](https://vercel.com)
3. Аккаунт на [Railway](https://railway.app)
4. API-ключ [OpenAI](https://platform.openai.com)

### Подготовка репозитория

1. Создайте новый репозиторий на GitHub
2. Загрузите код проекта BookPilot в репозиторий:
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/your-username/bookpilot.git
   git push -u origin main
   ```

## Развертывание бэкенда на Railway

1. Войдите в свой аккаунт на [Railway](https://railway.app)
2. Нажмите "New Project" и выберите "Deploy from GitHub repo"
3. Выберите ваш репозиторий с проектом BookPilot
4. В настройках проекта:
   - Укажите рабочую директорию: `/bookpilot`
   - Установите команду запуска: `cd backend && uvicorn main:app --host 0.0.0.0 --port $PORT`

5. Добавьте сервис базы данных PostgreSQL:
   - Нажмите "New" и выберите "Database" -> "PostgreSQL"
   - Railway автоматически создаст переменные окружения для подключения к базе данных

6. Настройте переменные окружения для бэкенда:
   - `SECRET_KEY`: Сгенерируйте секретный ключ для JWT
   - `OPENAI_API_KEY`: Ваш API-ключ OpenAI
   - `DATABASE_URL`: Railway автоматически предоставит эту переменную

7. Дождитесь завершения развертывания и скопируйте URL вашего бэкенда (понадобится для настройки фронтенда)

## Развертывание фронтенда на Vercel

1. Войдите в свой аккаунт на [Vercel](https://vercel.com)
2. Нажмите "Add New" -> "Project"
3. Выберите ваш репозиторий с проектом BookPilot
4. В настройках проекта:
   - Укажите рабочую директорию: `bookpilot/frontend`
   - Framework Preset: Next.js

5. Настройте переменные окружения для фронтенда:
   - `NEXT_PUBLIC_API_URL`: URL вашего бэкенда на Railway + `/api/v1` (например, https://bookpilot-production.up.railway.app/api/v1)

6. Нажмите "Deploy" и дождитесь завершения развертывания

## Проверка развернутого приложения

1. Откройте URL вашего фронтенда на Vercel
2. Зарегистрируйтесь в приложении
3. Загрузите книгу и проверьте генерацию учебного руководства
4. Протестируйте все функции приложения:
   - Просмотр учебных руководств
   - Отслеживание прогресса
   - Чат с книгой
   - Экспорт руководств в PDF

## Настройка домена (опционально)

### Настройка домена для фронтенда на Vercel

1. В панели управления Vercel перейдите в настройки проекта
2. Выберите "Domains"
3. Добавьте ваш домен и следуйте инструкциям по настройке DNS

### Настройка домена для бэкенда на Railway

1. В панели управления Railway перейдите в настройки проекта
2. Выберите "Settings" -> "Domains"
3. Добавьте ваш домен и следуйте инструкциям по настройке DNS

## Обновление приложения

Для обновления приложения просто внесите изменения в ваш GitHub репозиторий и отправьте их:

```bash
git add .
git commit -m "Update application"
git push
```

Vercel и Railway автоматически обнаружат изменения и перезапустят развертывание.

## Устранение неполадок

### Проблемы с бэкендом

1. Проверьте логи в панели управления Railway
2. Убедитесь, что все переменные окружения настроены правильно
3. Проверьте подключение к базе данных

### Проблемы с фронтендом

1. Проверьте логи сборки в панели управления Vercel
2. Убедитесь, что URL API настроен правильно
3. Проверьте консоль браузера на наличие ошибок

## Оптимизация и масштабирование

### Оптимизация производительности

1. Настройте кэширование статических ресурсов
2. Оптимизируйте изображения и другие медиа-файлы
3. Используйте CDN для доставки статического контента

### Масштабирование

1. Railway автоматически масштабирует ваш бэкенд при необходимости
2. Vercel обеспечивает глобальное распределение вашего фронтенда через CDN

## Мониторинг и аналитика

1. Настройте мониторинг с помощью инструментов, предоставляемых Vercel и Railway
2. Добавьте Google Analytics или другие инструменты аналитики для отслеживания пользовательской активности
3. Настройте оповещения о проблемах с производительностью или доступностью
